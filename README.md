See the comment at the top of the code.
